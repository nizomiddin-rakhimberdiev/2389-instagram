<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Instagram â€” Navbar (single file)</title>
  <style>
    :root{
      --bg: #fff;
      --muted: #8e8e8e;
      --border: #dbdbdb;
      --accent: #262626;
      --radius: 8px;
      --glass: rgba(255,255,255,0.6);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    /* SIMPLE RESET */
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#f7f7f7,#ffffff);color:var(--accent);}

    /* NAVBAR */
    .navbar{
      width:100%;
      background:var(--bg);
      border-bottom:1px solid var(--border);
      position:sticky;top:0;z-index:40;
      display:flex;align-items:center;justify-content:center;padding:8px 12px;
      backdrop-filter: blur(6px);
    }
    .container{max-width:975px;width:100%;display:flex;align-items:center;gap:20px}

    /* Left: logo */
    .brand{display:flex;align-items:center;gap:12px;flex:0 0 auto}
    .brand .logo{display:inline-flex;align-items:center;gap:8px;font-weight:600;font-size:18px}
    .logo svg{width:28px;height:28px}

    /* Center: search */
    .search-wrap{flex:1;display:flex;justify-content:center}
    .search{
      width:100%;max-width:350px;background:var(--glass);border:1px solid var(--border);padding:6px 10px;border-radius:8px;display:flex;align-items:center;gap:8px
    }
    .search input{flex:1;border:0;outline:0;background:transparent;font-size:14px;color:var(--accent)}
    .search input::placeholder{color:var(--muted);}

    /* Right: actions */
    .actions{display:flex;align-items:center;gap:12px;flex:0 0 auto}
    .icon-btn{width:34px;height:34px;display:inline-flex;align-items:center;justify-content:center;border-radius:8px;border:0;background:transparent;cursor:pointer}
    .icon-btn:hover{background:#f2f2f2}
    .profile-thumb{width:30px;height:30px;border-radius:50%;background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888);display:inline-block}

    /* Responsive: small screens */
    .mobile-only{display:none}
    @media (max-width:720px){
      .search-wrap{display:none}
      .brand .wordmark{display:none}
      .container{gap:8px}
      .mobile-only{display:inline-flex}
      .desktop-only{display:none}
    }

    /* Small utilities */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* Simple dropdown for mobile menu */
    .mobile-menu{position:absolute;right:12px;top:58px;background:var(--bg);border:1px solid var(--border);padding:8px;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.06);display:none;min-width:180px}
    .mobile-menu.show{display:block}
    .mobile-menu a{display:block;padding:8px 10px;text-decoration:none;color:var(--accent);border-radius:6px}
    .mobile-menu a:hover{background:#f7f7f7}

   /* SEARCH WRAPPER */
.search-box {
    position: relative;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: #fafafa;
    width: 260px;
}

/* INPUT */
.search-box input {
    border: none;
    outline: none;
    background: transparent;
    width: 100%;
    font-size: 14px;
    color: #262626;
}

.search-box input::placeholder {
    color: #8e8e8e;
}

/* DROPDOWN */
.search-results {
    position: absolute;
    top: 42px;
    left: 0;
    width: 100%;
    background: white;
    border: 1px solid #dbdbdb;
    border-radius: 12px;
    max-height: 300px;
    overflow-y: auto;
    display: none;
    z-index: 9999;
}

/* ITEM */
.search-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px;
    cursor: pointer;
    text-decoration: none;
    color: #262626;
}

.search-item:hover {
    background: #fafafa;
}

.search-item img {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    object-fit: cover;
}



  </style>
  {% block head %}

  {% endblock %}

</head>
<body>
  <nav class="navbar">
    <div class="container">
      <!-- Left: Logo / wordmark -->
      <div class="brand">
        <div class="logo" style="width: 40px;" aria-hidden="true">
          <!-- Camera-like glyph inspired by Instagram -->
          <img style="width: 100%;" src="/media/avatars/image.jpg" alt="">
          <a href="{% url 'home' %}" class="wordmark">Dinogram</a>
        </div>
      </div>

      <!-- Center: Search -->
      <div class="search-wrap">
    <div class="search-box">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.4"
                  stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.4"/>
        </svg>

        <input 
            type="text"
            id="searchInput"
            placeholder="Search"
            autocomplete="off"
        >

        <div id="searchResults" class="search-results"></div>
    </div>
</div>


      <!-- Right: actions -->
      <div class="actions">
        <button class="icon-btn desktop-only" title="Home" aria-label="Home">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 11.5L12 4l9 7.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V11.5z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <a href="{% url 'messages' %}" class="icon-btn desktop-only" title="Messages" aria-label="Messages">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>

        <button class="icon-btn desktop-only" title="Create" aria-label="Create">
          <a href="{% url 'create_post' %}">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
          </button>

        <button class="icon-btn desktop-only" title="Explore" aria-label="Explore">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21L16.65 16.65M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <button class="icon-btn desktop-only" title="Activity" aria-label="Activity">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20.8 4.6a5.5 5.5 0 0 0-7.78 0L12 5.61l-1.02-1.02a5.5 5.5 0 1 0-7.78 7.78L12 21.3l8.8-8.8a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <a href="{% url 'profile' request.user.username %}">
            <button class="icon-btn" id="profileBtn" aria-label="Profile" title="Profile">
          
            <img style="width: 100%;" src="{{ request.user.avatar.url }}" alt="avatar">
         
        </button>
        </a>

        <!-- Mobile: menu toggle -->
        <button class="icon-btn mobile-only" id="mobileToggle" aria-expanded="false" aria-label="Menu">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>

      <!-- Mobile menu (simple) -->
      <div class="mobile-menu" id="mobileMenu" role="menu" aria-hidden="true">
        <a href="#">Home</a>
        <a href="#">Messages</a>
        <a href="#">Create</a>
        <a href="#">Explore</a>
        <a href="#">Activity</a>
        <a href="#">Profile</a>
      </div>

    </div>
  </nav>

{% block content %}

{% endblock %}

  <script>
    // Mobile menu toggle
    const mobileToggle = document.getElementById('mobileToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    mobileToggle && mobileToggle.addEventListener('click', ()=>{
      const shown = mobileMenu.classList.toggle('show');
      mobileToggle.setAttribute('aria-expanded', shown);
      mobileMenu.setAttribute('aria-hidden', !shown);
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', (e)=>{
      if(!mobileMenu || !mobileToggle) return;
      if(!mobileMenu.classList.contains('show')) return;
      const isClickInside = mobileMenu.contains(e.target) || mobileToggle.contains(e.target);
      if(!isClickInside) mobileMenu.classList.remove('show');
    });
  </script>
<script>
const input = document.getElementById("searchInput");
const resultsBox = document.getElementById("searchResults");
let controller;

input.addEventListener("input", () => {
    const query = input.value.trim();

    if (!query) {
        resultsBox.style.display = "none";
        resultsBox.innerHTML = "";
        return;
    }

    if (controller) controller.abort();
    controller = new AbortController();

    fetch(`/search/?q=${query}`, { signal: controller.signal })
        .then(res => res.json())
        .then(data => {
            resultsBox.innerHTML = "";

            if (data.results.length === 0) {
                resultsBox.innerHTML = `
                    <div style="padding:10px;color:#8e8e8e">
                        No results
                    </div>`;
            } else {
                data.results.forEach(user => {
                    const a = document.createElement("a");
                    a.className = "search-item";
                    a.href = `/users/profile/${user.username}/`;

                    a.innerHTML = `
                        <img src="/media/${user.avatar}">
                        <span>${user.username}</span>
                    `;

                    resultsBox.appendChild(a);
                });
            }

            resultsBox.style.display = "block";
        })
        .catch(() => {});
});

document.addEventListener("click", e => {
    if (!e.target.closest(".search-box")) {
        resultsBox.style.display = "none";
    }
});
</script>
<script>
let socket;
let currentChat = null;

function openChat(chatId) {
    currentChat = chatId;
    document.getElementById("chatHeader").innerText = "Chat " + chatId;
    document.getElementById("messageInput").disabled = false;

    socket = new WebSocket(`ws://${window.location.host}/ws/chat/${chatId}/`);

    socket.onmessage = function(e) {
        const data = JSON.parse(e.data);
        const msgBox = document.getElementById("chatMessages");

        const div = document.createElement("div");
        div.className = "message";
        div.innerHTML = `<b>${data.username}:</b> ${data.message}`;
        msgBox.appendChild(div);
    };
}

function sendMessage() {
    const input = document.getElementById("messageInput");
    socket.send(JSON.stringify({message: input.value}));
    input.value = "";
}
</script>


</body>
</html>
